<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analisis_propensiones</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Analisis_propensiones_files/libs/clipboard/clipboard.min.js"></script>
<script src="Analisis_propensiones_files/libs/quarto-html/quarto.js"></script>
<script src="Analisis_propensiones_files/libs/quarto-html/popper.min.js"></script>
<script src="Analisis_propensiones_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Analisis_propensiones_files/libs/quarto-html/anchor.min.js"></script>
<link href="Analisis_propensiones_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Analisis_propensiones_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Analisis_propensiones_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Analisis_propensiones_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Analisis_propensiones_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analisis_propensiones</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="carga-de-librerías" class="level1">
<h1>Carga de Librerías</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'pacman'</span>)){<span class="fu">install.packages</span>(<span class="st">'pacman'</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,survey, tableone, ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>datos_imputados <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'Datos_imputados.rds'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="sc">-</span>NHC), identificador, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>datos_imputados</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 371 × 50
   identificador Grup_IQ edat_IQ sexe_home   Pes Talla_m   IMC plaquetes_preIQ
           &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;
 1             1 No IQ        70 home         87    1.71  29.8              67
 2             2 No IQ        79 dona         56    1.56  23.0             182
 3             3 No IQ        64 home         73    1.7   25.3              66
 4             4 No IQ        58 dona         50    1.57  20.3             152
 5             5 No IQ        54 home         99    1.73  33.1              60
 6             6 No IQ        70 home        125    1.8   38.6             102
 7             7 No IQ        74 dona         62    1.5   27.6             104
 8             8 No IQ        74 dona         71    1.48  32.4             104
 9             9 No IQ        74 dona         58    1.56  23.8             104
10            10 No IQ        82 dona         60    1.59  23.7              61
# ℹ 361 more rows
# ℹ 42 more variables: Alb_gL_preIQ &lt;dbl&gt;, BB_mgdL_preIQ &lt;dbl&gt;,
#   INR_preIQ &lt;dbl&gt;, AST_preIQ &lt;dbl&gt;, ALT_preIQ &lt;dbl&gt;, FA_preIQ &lt;dbl&gt;,
#   GGT_preIQ &lt;dbl&gt;, Urea_mgdL_preIQ &lt;dbl&gt;, Creat_mgdL_preIQ &lt;dbl&gt;,
#   MidaMelsa_mm &lt;dbl&gt;, FsC_Elastografia &lt;dbl&gt;, FsC &lt;dbl&gt;, hvpg &lt;dbl&gt;,
#   Charlson_Index &lt;dbl&gt;, Pughpunts_basal &lt;dbl&gt;, MELD_basal &lt;dbl&gt;,
#   Enol_Actiu &lt;fct&gt;, DIabetes &lt;fct&gt;, etiol_OH &lt;fct&gt;, TTO_Estatinas &lt;fct&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>datos_imputados_transformados <span class="ot">&lt;-</span> datos_imputados <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">DIabetes =</span> <span class="fu">droplevels</span>(DIabetes,<span class="fu">c</span>(<span class="st">'Metformina'</span>, <span class="st">'Altres'</span>,<span class="st">'ADO'</span>, <span class="st">'dieta'</span>, <span class="st">'ADO+Insulina'</span>,<span class="st">'metformina+altres'</span>,<span class="st">'ADO'</span>)),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">SignesIndirectes_HTP =</span> <span class="fu">droplevels</span>(SignesIndirectes_HTP,<span class="fu">c</span>(<span class="st">'dubtós'</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">presenciaCSPH =</span> <span class="fu">case_when</span>(presenciaCSPH <span class="sc">==</span><span class="st">'indeterminat'</span> <span class="sc">~</span> <span class="st">'no CSPH'</span>, <span class="cn">TRUE</span> <span class="sc">~</span> presenciaCSPH)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'identificador'</span>,<span class="st">'Grup_IQ'</span>,<span class="st">'edat_IQ'</span>,<span class="st">'sexe_home'</span>,<span class="st">"IMC"</span>,<span class="st">'etiol_OH'</span>,<span class="st">'Enol_Actiu'</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Charlson_Index"</span>,<span class="st">"plaquetes_preIQ"</span>,<span class="st">"DIabetes"</span>,<span class="st">'Pughpunts_basal'</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'colaterals_shunts'</span>,<span class="st">'MELD_basal'</span>,<span class="st">'Alb_gL_preIQ'</span>,<span class="st">'INR_preIQ'</span>,<span class="st">'BB_mgdL_preIQ'</span>,<span class="st">'Creat_mgdL_preIQ'</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">'HCC_prev'</span>,<span class="st">'SignesIndirectes_HTP'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>variables_propensity <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Grup_IQ'</span>,<span class="st">'edat_IQ'</span>,<span class="st">'sexe_home'</span>,<span class="st">"IMC"</span>,<span class="st">'etiol_OH'</span>,<span class="st">'Enol_Actiu'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Charlson_Index"</span>,<span class="st">"plaquetes_preIQ"</span>,<span class="st">"DIabetes"</span>,<span class="st">'Pughpunts_basal'</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'colaterals_shunts'</span>,<span class="st">'MELD_basal'</span>,<span class="st">'Alb_gL_preIQ'</span>,<span class="st">'INR_preIQ'</span>,<span class="st">'BB_mgdL_preIQ'</span>,<span class="st">'Creat_mgdL_preIQ'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'HCC_prev'</span>,<span class="st">'SignesIndirectes_HTP'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelo-propensity-1-todo-mal" class="level1">
<h1>Modelo propensity 1: todo mal</h1>
<section id="ajuste-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-del-modelo">Ajuste del modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod_propensity_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Grup_IQ <span class="sc">~</span>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    HCC_prev <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    sexe_home <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    Charlson_Index</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos_imputados_transformados, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sacando-iptw" class="level3">
<h3 class="anchored" data-anchor-id="sacando-iptw">Sacando IPTW</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_1 <span class="ot">&lt;-</span> datos_imputados_transformados <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">prediciones =</span> <span class="fu">predict</span>( mod_propensity_1 , datos_imputados_transformados , <span class="at">type=</span><span class="st">"response"</span>) )</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_1 <span class="ot">&lt;-</span> datos_imputados_propensity_1 <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">standarized_weights =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'Si IQ'</span> <span class="sc">~</span> (<span class="dv">177</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (  prediciones),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'No IQ'</span> <span class="sc">~</span> (<span class="dv">194</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>prediciones) </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="revisión" class="level3">
<h3 class="anchored" data-anchor-id="revisión">Revisión</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 371 × 21
   identificador Grup_IQ edat_IQ sexe_home   IMC etiol_OH Enol_Actiu
           &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;     
 1             1 No IQ        70 home       29.8 no       no        
 2             2 No IQ        79 dona       23.0 no       no        
 3             3 No IQ        64 home       25.3 no       no        
 4             4 No IQ        58 dona       20.3 si       si        
 5             5 No IQ        54 home       33.1 si       si        
 6             6 No IQ        70 home       38.6 no       no        
 7             7 No IQ        74 dona       27.6 no       no        
 8             8 No IQ        74 dona       32.4 no       no        
 9             9 No IQ        74 dona       23.8 no       no        
10            10 No IQ        82 dona       23.7 no       no        
# ℹ 361 more rows
# ℹ 14 more variables: Charlson_Index &lt;dbl&gt;, plaquetes_preIQ &lt;dbl&gt;,
#   DIabetes &lt;fct&gt;, Pughpunts_basal &lt;dbl&gt;, colaterals_shunts &lt;fct&gt;,
#   MELD_basal &lt;dbl&gt;, Alb_gL_preIQ &lt;dbl&gt;, INR_preIQ &lt;dbl&gt;, BB_mgdL_preIQ &lt;dbl&gt;,
#   Creat_mgdL_preIQ &lt;dbl&gt;, HCC_prev &lt;fct&gt;, SignesIndirectes_HTP &lt;fct&gt;,
#   prediciones &lt;dbl&gt;, standarized_weights &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">list</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_1 <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_1 <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_1 <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_1 <span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis_propensiones_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>iptwdatos_propensity_survey_1 <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos_imputados_propensity_1,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="sc">~</span>Grup_IQ,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span> datos_imputados_propensity_1<span class="sc">$</span>standarized_weights)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Propensity_table_Weighted_1 <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars=</span> datos_imputados_propensity_1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Grup_IQ, identificador,standarized_weights,prediciones )) <span class="sc">%&gt;%</span> <span class="fu">names</span>(),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="st">"Grup_IQ"</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> iptwdatos_propensity_survey_1, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">addOverall =</span> T,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">includeNA =</span> T,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">smd =</span><span class="cn">TRUE</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Propensity_table_Weighted_1, <span class="at">smd =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Stratified by Grup_IQ
                                Overall        No IQ          Si IQ         
  n                             370.23         182.89         187.34        
  edat_IQ (mean (SD))            64.44 (11.01)  64.17 (10.66)  64.70 (11.36)
  sexe_home = home (%)           227.1 (61.3)   112.8 (61.7)   114.3 (61.0) 
  IMC (mean (SD))                27.21 (5.07)   27.66 (4.45)   26.77 (5.58) 
  etiol_OH = si (%)              116.4 (31.4)    61.8 (33.8)    54.6 (29.2) 
  Enol_Actiu = si (%)             62.0 (16.8)    29.7 (16.3)    32.3 (17.2) 
  Charlson_Index (mean (SD))      4.96 (1.98)    4.96 (1.55)    4.95 (2.33) 
  plaquetes_preIQ (mean (SD))   125.50 (66.52) 102.53 (45.09) 147.92 (75.91)
  DIabetes = insulina (%)        121.7 (32.9)    70.9 (38.8)    50.9 (27.1) 
  Pughpunts_basal (mean (SD))     5.59 (1.00)    5.55 (0.87)    5.62 (1.11) 
  colaterals_shunts = si (%)     154.6 (41.8)    85.2 (46.6)    69.4 (37.0) 
  MELD_basal (mean (SD))          9.31 (2.92)    9.42 (2.21)    9.21 (3.49) 
  Alb_gL_preIQ (mean (SD))       36.72 (5.61)   36.69 (5.00)   36.74 (6.15) 
  INR_preIQ (mean (SD))           1.17 (0.20)    1.18 (0.14)    1.16 (0.24) 
  BB_mgdL_preIQ (mean (SD))       1.25 (0.91)    1.35 (0.83)    1.17 (0.98) 
  Creat_mgdL_preIQ (mean (SD))    0.87 (0.39)    0.82 (0.21)    0.92 (0.50) 
  HCC_prev = si (%)               35.5 ( 9.6)    15.7 ( 8.6)    19.8 (10.6) 
  SignesIndirectes_HTP = si (%)  306.3 (82.7)   180.7 (98.8)   125.7 (67.1) 
                               Stratified by Grup_IQ
                                p      test SMD   
  n                                               
  edat_IQ (mean (SD))            0.696       0.048
  sexe_home = home (%)           0.911       0.013
  IMC (mean (SD))                0.168       0.177
  etiol_OH = si (%)              0.411       0.099
  Enol_Actiu = si (%)            0.823       0.026
  Charlson_Index (mean (SD))     0.985       0.002
  plaquetes_preIQ (mean (SD))   &lt;0.001       0.727
  DIabetes = insulina (%)        0.029       0.249
  Pughpunts_basal (mean (SD))    0.598       0.073
  colaterals_shunts = si (%)     0.106       0.195
  MELD_basal (mean (SD))         0.549       0.073
  Alb_gL_preIQ (mean (SD))       0.935       0.010
  INR_preIQ (mean (SD))          0.359       0.109
  BB_mgdL_preIQ (mean (SD))      0.106       0.199
  Creat_mgdL_preIQ (mean (SD))   0.015       0.248
  HCC_prev = si (%)              0.633       0.069
  SignesIndirectes_HTP = si (%) &lt;0.001       0.929</code></pre>
</div>
</div>
</section>
</section>
<section id="modelo-propensity-2-mejor-pero-todavía-no-cuadra" class="level1">
<h1>Modelo propensity 2: mejor, pero todavía no cuadra</h1>
<p>Supón que ha habido unos 300 modelos entremedio, pero ya está. <strong>No hemos conseguido afinar más la fórmula</strong>. Esta es el mejor propensity que hemos logrado. Veamos que tal ajusta.</p>
<section id="ajuste-del-modelo-1" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-del-modelo-1">Ajuste del modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod_propensity_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Grup_IQ <span class="sc">~</span>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    SignesIndirectes_HTP <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    HCC_prev <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    DIabetes <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    sexe_home <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    Enol_Actiu <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    plaquetes_preIQ <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">sqrt</span>(Charlson_Index)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    Alb_gL_preIQ <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(IMC) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    Pughpunts_basal <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(BB_mgdL_preIQ) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    Creat_mgdL_preIQ <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    INR_preIQ</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos_imputados_transformados, </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sacando-iptw-1" class="level3">
<h3 class="anchored" data-anchor-id="sacando-iptw-1">Sacando IPTW</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_2 <span class="ot">&lt;-</span> datos_imputados_transformados <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediciones =</span> <span class="fu">predict</span>(mod_propensity_2, datos_imputados_transformados, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_2 <span class="ot">&lt;-</span> datos_imputados_propensity_2 <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">standarized_weights =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'Si IQ'</span> <span class="sc">~</span> (<span class="dv">177</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (  prediciones),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'No IQ'</span> <span class="sc">~</span> (<span class="dv">194</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>prediciones) </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>datos_imputados_propensity_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 371 × 21
   identificador Grup_IQ edat_IQ sexe_home   IMC etiol_OH Enol_Actiu
           &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;     
 1             1 No IQ        70 home       29.8 no       no        
 2             2 No IQ        79 dona       23.0 no       no        
 3             3 No IQ        64 home       25.3 no       no        
 4             4 No IQ        58 dona       20.3 si       si        
 5             5 No IQ        54 home       33.1 si       si        
 6             6 No IQ        70 home       38.6 no       no        
 7             7 No IQ        74 dona       27.6 no       no        
 8             8 No IQ        74 dona       32.4 no       no        
 9             9 No IQ        74 dona       23.8 no       no        
10            10 No IQ        82 dona       23.7 no       no        
# ℹ 361 more rows
# ℹ 14 more variables: Charlson_Index &lt;dbl&gt;, plaquetes_preIQ &lt;dbl&gt;,
#   DIabetes &lt;fct&gt;, Pughpunts_basal &lt;dbl&gt;, colaterals_shunts &lt;fct&gt;,
#   MELD_basal &lt;dbl&gt;, Alb_gL_preIQ &lt;dbl&gt;, INR_preIQ &lt;dbl&gt;, BB_mgdL_preIQ &lt;dbl&gt;,
#   Creat_mgdL_preIQ &lt;dbl&gt;, HCC_prev &lt;fct&gt;, SignesIndirectes_HTP &lt;fct&gt;,
#   prediciones &lt;dbl&gt;, standarized_weights &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="revisión-1" class="level3">
<h3 class="anchored" data-anchor-id="revisión-1">Revisión</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">list</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_2 <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_2 <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_2 <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    datos_imputados_propensity_2 <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis_propensiones_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>iptwdatos_propensity_2 <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos_imputados_propensity_2,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="sc">~</span>Grup_IQ,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span> datos_imputados_propensity_2<span class="sc">$</span>standarized_weights)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>Propensity_table_Weighted_2 <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars=</span> datos_imputados_propensity_2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Grup_IQ, identificador,standarized_weights,prediciones )) <span class="sc">%&gt;%</span> <span class="fu">names</span>(),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="st">"Grup_IQ"</span>, </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> iptwdatos_propensity_2, </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">addOverall =</span> T,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">includeNA =</span> T,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">smd =</span><span class="cn">TRUE</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Propensity_table_Weighted_2, <span class="at">smd =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Stratified by Grup_IQ
                                Overall        No IQ          Si IQ         
  n                             353.56         166.15         187.42        
  edat_IQ (mean (SD))            64.47 (10.77)  64.03 (10.58)  64.85 (10.95)
  sexe_home = home (%)           221.4 (62.6)   105.6 (63.6)   115.8 (61.8) 
  IMC (mean (SD))                27.31 (4.84)   27.27 (4.36)   27.35 (5.24) 
  etiol_OH = si (%)              109.6 (31.0)    54.3 (32.7)    55.4 (29.5) 
  Enol_Actiu = si (%)             61.0 (17.3)    28.6 (17.2)    32.4 (17.3) 
  Charlson_Index (mean (SD))      4.98 (2.08)    4.86 (1.44)    5.08 (2.51) 
  plaquetes_preIQ (mean (SD))   115.98 (58.26) 107.56 (50.39) 123.44 (63.65)
  DIabetes = insulina (%)        117.1 (33.1)    57.9 (34.9)    59.1 (31.5) 
  Pughpunts_basal (mean (SD))     5.59 (0.99)    5.63 (0.91)    5.56 (1.06) 
  colaterals_shunts = si (%)     158.5 (44.8)    75.3 (45.3)    83.2 (44.4) 
  MELD_basal (mean (SD))          9.25 (2.70)    9.40 (2.20)    9.13 (3.08) 
  Alb_gL_preIQ (mean (SD))       36.52 (5.51)   36.30 (5.16)   36.70 (5.81) 
  INR_preIQ (mean (SD))           1.17 (0.19)    1.18 (0.14)    1.16 (0.23) 
  BB_mgdL_preIQ (mean (SD))       1.23 (0.81)    1.27 (0.79)    1.19 (0.82) 
  Creat_mgdL_preIQ (mean (SD))    0.85 (0.35)    0.83 (0.22)    0.87 (0.44) 
  HCC_prev = si (%)               33.0 ( 9.3)    13.3 ( 8.0)    19.6 (10.5) 
  SignesIndirectes_HTP = si (%)  316.5 (89.5)   159.4 (95.9)   157.1 (83.8) 
                               Stratified by Grup_IQ
                                p      test SMD   
  n                                               
  edat_IQ (mean (SD))            0.572       0.077
  sexe_home = home (%)           0.781       0.037
  IMC (mean (SD))                0.908       0.016
  etiol_OH = si (%)              0.619       0.068
  Enol_Actiu = si (%)            0.988       0.002
  Charlson_Index (mean (SD))     0.482       0.111
  plaquetes_preIQ (mean (SD))    0.029       0.276
  DIabetes = insulina (%)        0.591       0.071
  Pughpunts_basal (mean (SD))    0.668       0.072
  colaterals_shunts = si (%)     0.889       0.019
  MELD_basal (mean (SD))         0.396       0.102
  Alb_gL_preIQ (mean (SD))       0.612       0.073
  INR_preIQ (mean (SD))          0.357       0.104
  BB_mgdL_preIQ (mean (SD))      0.418       0.101
  Creat_mgdL_preIQ (mean (SD))   0.297       0.107
  HCC_prev = si (%)              0.607       0.084
  SignesIndirectes_HTP = si (%)  0.010       0.409</code></pre>
</div>
</div>
</section>
</section>
<section id="filtrado-de-pacientes-que-no-interesan" class="level1">
<h1>Filtrado de pacientes que no interesan</h1>
<p>Se puede utilizar el resultado de un propensity para encajar otro. en este caso. Utilizamos los resultados de un propensity previo para poder crear uno nuevo con restricción de casos outlier que no iban a encajar de ninguna forma</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrado de pacientes excluídos por no encajar en ningún propensity score ----</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Pacientes_excluidos_propensity <span class="ot">&lt;-</span> datos_imputados_propensity_2 <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">between</span>(prediciones,<span class="fl">0.1</span>,<span class="fl">0.80</span>)) <span class="sc">%&gt;%</span> <span class="co"># eliminamos los propensities extremos.  </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(prediciones,standarized_weights))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>Pacientes_excluidos_propensity<span class="sc">$</span>identificador</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   5  17  51  58  60  67  83  86 118 121 129 135 137 162 167 168 177 190
 [19] 195 197 199 200 205 206 207 212 213 214 215 216 217 221 222 225 229 231
 [37] 232 233 234 238 240 244 246 247 249 250 252 253 255 257 259 260 262 263
 [55] 268 270 271 273 275 277 280 281 285 288 290 293 296 297 298 306 308 313
 [73] 319 321 322 323 324 325 328 332 333 334 336 337 338 339 340 343 344 347
 [91] 348 349 352 353 356 358 359 361 364 365 367</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrado de pacientes incluidos por  encajar en  propensity score ---- </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Pacientes_finales <span class="ot">&lt;-</span> datos_imputados_propensity_2 <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(prediciones,<span class="fl">0.1</span>,<span class="fl">0.80</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(prediciones,standarized_weights))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>Pacientes_finales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 19
   identificador Grup_IQ edat_IQ sexe_home   IMC etiol_OH Enol_Actiu
           &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;     
 1             1 No IQ        70 home       29.8 no       no        
 2             2 No IQ        79 dona       23.0 no       no        
 3             3 No IQ        64 home       25.3 no       no        
 4             4 No IQ        58 dona       20.3 si       si        
 5             6 No IQ        70 home       38.6 no       no        
 6             7 No IQ        74 dona       27.6 no       no        
 7             8 No IQ        74 dona       32.4 no       no        
 8             9 No IQ        74 dona       23.8 no       no        
 9            10 No IQ        82 dona       23.7 no       no        
10            11 No IQ        75 dona       29.3 no       no        
# ℹ 260 more rows
# ℹ 12 more variables: Charlson_Index &lt;dbl&gt;, plaquetes_preIQ &lt;dbl&gt;,
#   DIabetes &lt;fct&gt;, Pughpunts_basal &lt;dbl&gt;, colaterals_shunts &lt;fct&gt;,
#   MELD_basal &lt;dbl&gt;, Alb_gL_preIQ &lt;dbl&gt;, INR_preIQ &lt;dbl&gt;, BB_mgdL_preIQ &lt;dbl&gt;,
#   Creat_mgdL_preIQ &lt;dbl&gt;, HCC_prev &lt;fct&gt;, SignesIndirectes_HTP &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="modelo-propensity-final" class="level1">
<h1>Modelo Propensity final</h1>
<section id="ajuste-del-modelo-2" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-del-modelo-2">Ajuste del modelo</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mod_propensity_final <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Grup_IQ <span class="sc">~</span>  </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    SignesIndirectes_HTP <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    HCC_prev <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    DIabetes <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    sexe_home <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    Enol_Actiu <span class="sc">+</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    plaquetes_preIQ <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">sqrt</span>(Charlson_Index)) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    Alb_gL_preIQ <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(IMC) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    Pughpunts_basal <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(BB_mgdL_preIQ) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    Creat_mgdL_preIQ <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    INR_preIQ</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  , </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Pacientes_finales, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sacando-iptw-2" class="level3">
<h3 class="anchored" data-anchor-id="sacando-iptw-2">Sacando IPTW</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Pacientes_finales_IPTW <span class="ot">&lt;-</span> Pacientes_finales <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediciones=</span><span class="fu">predict</span>(mod_propensity_final,Pacientes_finales,<span class="at">type=</span><span class="st">"response"</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">standarized_weights =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'Si IQ'</span> <span class="sc">~</span> (<span class="dv">177</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (  prediciones),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    Grup_IQ <span class="sc">==</span> <span class="st">'No IQ'</span> <span class="sc">~</span> (<span class="dv">194</span><span class="sc">/</span>(<span class="dv">371</span>))<span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>prediciones) </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="revisión-2" class="level3">
<h3 class="anchored" data-anchor-id="revisión-2">Revisión</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">list</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    Pacientes_finales_IPTW <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    Pacientes_finales_IPTW <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(standarized_weights, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    Pacientes_finales_IPTW <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    Pacientes_finales_IPTW <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(prediciones, <span class="at">fill =</span> Grup_IQ)) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">'black'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'probabilidad de pertenecer grup Si en propensity'</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis_propensiones_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos propensity ----</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>Pacientes_finales_iptw_survey <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Pacientes_finales_IPTW,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="sc">~</span>Grup_IQ,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span> Pacientes_finales_IPTW<span class="sc">$</span>standarized_weights)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Pacientes_finales_IPTW_table_Weighted <span class="ot">&lt;-</span> <span class="fu">svyCreateTableOne</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars=</span> Pacientes_finales_IPTW <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Grup_IQ, identificador,standarized_weights,prediciones )) <span class="sc">%&gt;%</span> <span class="fu">names</span>(),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> <span class="st">"Grup_IQ"</span>, </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> Pacientes_finales_iptw_survey, </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">addOverall =</span> T,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">includeNA =</span> T,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">smd =</span><span class="cn">TRUE</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Pacientes_finales_IPTW_table_Weighted , <span class="at">smd =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Stratified by Grup_IQ
                                Overall        No IQ          Si IQ         
  n                             274.58         140.96         133.63        
  edat_IQ (mean (SD))            64.62 (10.73)  64.42 (10.74)  64.82 (10.77)
  sexe_home = home (%)           169.5 (61.7)    87.2 (61.9)    82.3 (61.6) 
  IMC (mean (SD))                27.14 (4.55)   27.06 (3.81)   27.21 (5.23) 
  etiol_OH = si (%)               89.4 (32.5)    47.4 (33.6)    42.0 (31.4) 
  Enol_Actiu = si (%)             44.0 (16.0)    23.0 (16.3)    21.1 (15.8) 
  Charlson_Index (mean (SD))      4.89 (1.93)    4.86 (1.46)    4.91 (2.33) 
  plaquetes_preIQ (mean (SD))   110.76 (50.95) 109.21 (49.88) 112.38 (52.25)
  DIabetes = insulina (%)         92.4 (33.7)    48.8 (34.6)    43.6 (32.6) 
  Pughpunts_basal (mean (SD))     5.54 (0.96)    5.56 (0.81)    5.53 (1.10) 
  colaterals_shunts = si (%)     129.4 (47.1)    64.2 (45.6)    65.2 (48.8) 
  MELD_basal (mean (SD))          9.17 (2.73)    9.28 (2.20)    9.04 (3.21) 
  Alb_gL_preIQ (mean (SD))       36.73 (5.45)   36.57 (5.06)   36.90 (5.86) 
  INR_preIQ (mean (SD))           1.17 (0.21)    1.17 (0.14)    1.17 (0.27) 
  BB_mgdL_preIQ (mean (SD))       1.21 (0.73)    1.22 (0.68)    1.20 (0.78) 
  Creat_mgdL_preIQ (mean (SD))    0.84 (0.26)    0.85 (0.22)    0.83 (0.30) 
  HCC_prev = si (%)               11.4 ( 4.1)     6.0 ( 4.3)     5.3 ( 4.0) 
  SignesIndirectes_HTP = si (%)  271.6 (98.9)   139.4 (98.9)   132.2 (99.0) 
                               Stratified by Grup_IQ
                                p      test SMD   
  n                                               
  edat_IQ (mean (SD))            0.802       0.038
  sexe_home = home (%)           0.971       0.006
  IMC (mean (SD))                0.841       0.033
  etiol_OH = si (%)              0.761       0.047
  Enol_Actiu = si (%)            0.922       0.015
  Charlson_Index (mean (SD))     0.887       0.024
  plaquetes_preIQ (mean (SD))    0.686       0.062
  DIabetes = insulina (%)        0.778       0.042
  Pughpunts_basal (mean (SD))    0.818       0.035
  colaterals_shunts = si (%)     0.676       0.064
  MELD_basal (mean (SD))         0.571       0.087
  Alb_gL_preIQ (mean (SD))       0.709       0.059
  INR_preIQ (mean (SD))          0.995       0.001
  BB_mgdL_preIQ (mean (SD))      0.837       0.030
  Creat_mgdL_preIQ (mean (SD))   0.677       0.057
  HCC_prev = si (%)              0.903       0.015
  SignesIndirectes_HTP = si (%)  0.961       0.006</code></pre>
</div>
</div>
</section>
</section>
<section id="ahora-ya-esta-todo-equilirbado" class="level1">
<h1>Ahora ya esta todo equilirbado</h1>
<p>Ahora teniendo los id’s de los pacientes en claro y estos pesos, podemos ir a hacer cualquier análisis que permita ponderación y se harán con una confusión perfectamente controlada.</p>
<p>regresiones lineales o modelos de supervivencia son las opciones más plausibles para este método.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Pacientes_finales_IPTW <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(identificador, standarized_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 2
   identificador standarized_weights
           &lt;int&gt;               &lt;dbl&gt;
 1             1               0.697
 2             2               0.879
 3             3               0.707
 4             4               1.12 
 5             6               0.720
 6             7               0.627
 7             8               0.756
 8             9               0.761
 9            10               0.719
10            11               1.51 
# ℹ 260 more rows</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>